1. error handling

2. use libevent

3. cleaner buffer related code
